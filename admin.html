<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Aviation Store</title>
    <link rel="stylesheet" href="admin-style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="nav-brand">
                <i class="fas fa-chart-line"></i>
                <h1>Admin Dashboard</h1>
            </div>
            <nav class="nav">
                <a href="index.html">
                    <i class="fas fa-arrow-left"></i>
                    Retour au site
                </a>
                <button type="button" onclick="exportData()">
                    <i class="fas fa-download"></i>
                    Exporter
                </button>
            </nav>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <!-- Statistics Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-sales">0</h3>
                        <p>Ventes Totales</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-euro-sign"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-revenue">0€</h3>
                        <p>Chiffre d'Affaires</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="best-product">-</h3>
                        <p>Produit le Plus Vendu</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-calendar-day"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="today-sales">0</h3>
                        <p>Ventes Aujourd'hui</p>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="charts-grid">
                <!-- Sales Over Time Chart -->
                <div class="chart-container">
                    <div class="chart-header">
                        <h2>Ventes par Jour</h2>
                        <div class="chart-controls">
                            <button class="btn btn-small" onclick="updateTimeRange('7')">7 jours</button>
                            <button class="btn btn-small active" onclick="updateTimeRange('30')">30 jours</button>
                            <button class="btn btn-small" onclick="updateTimeRange('90')">90 jours</button>
                        </div>
                    </div>
                    <canvas id="salesChart"></canvas>
                </div>

                <!-- Products Chart -->
                <div class="chart-container">
                    <div class="chart-header">
                        <h2>Répartition des Ventes par Produit</h2>
                    </div>
                    <canvas id="productsChart"></canvas>
                </div>

                <!-- Category Chart -->
                <div class="chart-container">
                    <div class="chart-header">
                        <h2>Ventes par Catégorie</h2>
                    </div>
                    <canvas id="categoryChart"></canvas>
                </div>

                <!-- Revenue Chart -->
                <div class="chart-container">
                    <div class="chart-header">
                        <h2>Évolution du Chiffre d'Affaires</h2>
                    </div>
                    <canvas id="revenueChart"></canvas>
                </div>
            </div>

            <!-- Sales Table -->
            <div class="table-container">
                <div class="table-header">
                    <h2>Dernières Ventes</h2>
                    <div class="table-controls">
                        <input type="date" id="date-filter" onchange="filterSalesByDate()" aria-label="Filtrer par date" title="Sélectionner une date pour filtrer les ventes">
                        <button class="btn btn-small" onclick="clearFilters()">Tout afficher</button>
                    </div>
                </div>
                <div class="table-wrapper">
                    <table id="sales-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Produit</th>
                                <th>Prix</th>
                                <th>Heure</th>
                            </tr>
                        </thead>
                        <tbody id="sales-tbody">
                            <!-- Sales data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Products Management Section -->
            <div class="products-management">
                <div class="management-header">
                    <h2>Gestion des Produits</h2>
                    <button class="btn btn-primary" onclick="openAddProductModal()">
                        <i class="fas fa-plus"></i>
                        Ajouter un produit
                    </button>
                </div>
                
                <div class="products-grid-admin">
                    <div id="admin-products-list">
                        <!-- Products will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Sample Data Generator -->
            <div class="admin-tools">
                <div class="tool-card">
                    <h3>Outils d'Administration</h3>
                    <div class="tool-buttons">
                        <button class="btn btn-primary" onclick="generateSampleData()">
                            <i class="fas fa-database"></i>
                            Générer des données d'exemple
                        </button>
                        <button class="btn btn-secondary" onclick="clearAllData()">
                            <i class="fas fa-trash"></i>
                            Effacer toutes les données
                        </button>
                        <button class="btn btn-info" onclick="refreshData()">
                            <i class="fas fa-sync"></i>
                            Actualiser
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Product Management Modals -->
    <!-- Add/Edit Product Modal -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="product-modal-title">Ajouter un Produit</h2>
                <button class="close" onclick="closeProductModal()" aria-label="Fermer" onkeydown="if(event.key==='Enter'||event.key===' '){closeProductModal()}">&times;</button>
            </div>
            <div class="modal-body">
                <form id="product-form" onsubmit="saveProduct(event)">
                    <input type="hidden" id="product-id" value="">
                    
                    <div class="form-group">
                        <label for="product-name">Nom du produit *</label>
                        <input type="text" id="product-name" name="name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="product-price">Prix (€) *</label>
                        <input type="number" id="product-price" name="price" step="0.01" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="product-category">Catégorie *</label>
                        <select id="product-category" name="category" required>
                            <option value="">Sélectionner une catégorie</option>
                            <option value="tshirts">T-shirts</option>
                            <option value="accessories">Accessoires</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="product-icon">Icône Font Awesome</label>
                        <input type="text" id="product-icon" name="icon" placeholder="fas fa-tshirt">
                        <small>Exemple: fas fa-tshirt, fas fa-compass, fas fa-key</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="product-description">Description</label>
                        <textarea id="product-description" name="description" rows="3" placeholder="Description du produit (optionnel)"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeProductModal()">Annuler</button>
                <button type="submit" form="product-form" class="btn btn-primary">
                    <i class="fas fa-save"></i>
                    Enregistrer
                </button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Confirmer la suppression</h2>
                <button class="close" onclick="closeDeleteModal()" aria-label="Fermer" onkeydown="if(event.key==='Enter'||event.key===' '){closeDeleteModal()}">&times;</button>
            </div>
            <div class="modal-body">
                <div class="delete-confirmation">
                    <i class="fas fa-exclamation-triangle"></i>
                    <p>Êtes-vous sûr de vouloir supprimer ce produit ?</p>
                    <p><strong id="delete-product-name"></strong></p>
                    <p class="warning">Cette action est irréversible.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeDeleteModal()">Annuler</button>
                <button type="button" class="btn btn-danger" onclick="confirmDeleteProduct()">
                    <i class="fas fa-trash"></i>
                    Supprimer
                </button>
            </div>
        </div>
    </div>

    <script src="admin-script.js"></script>
</body>
</html>
